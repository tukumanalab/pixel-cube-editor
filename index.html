<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pixel Cube Editor</title>
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/editor.css">
  <link rel="stylesheet" href="/css/controls.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <div id="app">
    <header class="app-header">
      <h1>Pixel Cube Editor</h1>
      <div class="header-actions">
        <button id="import-btn" class="btn-secondary">ãƒ–ãƒ­ãƒƒã‚¯ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</button>
        <button id="export-btn" class="btn-primary">ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
      </div>
    </header>

    <!-- Toolbar Area -->
    <div class="app-toolbar">
      <div class="history-controls">
        <button id="undo-btn" class="btn-icon" title="å…ƒã«æˆ»ã™ (Ctrl+Z)" disabled>â†¶ Undo</button>
        <button id="redo-btn" class="btn-icon" title="ã‚„ã‚Šç›´ã— (Ctrl+Y)" disabled>â†· Redo</button>
      </div>
      <div class="brush-size-controls">
        <button id="brush-size-1" class="btn-brush active" title="ç´°ã„ãƒšãƒ³ (1px)">â—</button>
        <button id="brush-size-2" class="btn-brush" title="ä¸­å¤ªãƒšãƒ³ (2px)">â—</button>
        <button id="brush-size-3" class="btn-brush" title="å¤ªã„ãƒšãƒ³ (3px)">â—</button>
      </div>
      <div class="tool-controls">
        <button id="replace-color-btn" class="btn-icon" title="è‰²ã‚’ç½®æ›">ğŸ¨ è‰²ã‚’ç½®æ›</button>
      </div>
      <div class="color-controls">
        <input type="color" id="color-picker" value="#000000">
        <button id="add-color-btn" class="btn-icon" title="ãƒ‘ãƒ¬ãƒƒãƒˆã«è¿½åŠ ">â†’</button>
      </div>
      <div class="palette-container">
        <div id="palette-grid" class="palette-grid"></div>
        <div id="face-colors-grid" class="palette-grid face-colors-grid"></div>
      </div>
    </div>

    <div class="app-layout">
      <!-- Main Section: Preview and Editor -->
      <div class="main-section">
        <!-- 3D Preview -->
        <div class="preview-section">
          <div id="three-preview" class="preview-container"></div>
        </div>

        <!-- Pixel Editor -->
        <div class="editor-section">
          <!-- Face Selector -->
          <div class="face-selector">
            <div class="face-tabs">
              <button class="face-tab active" data-face="front">Front</button>
              <button class="face-tab" data-face="back">Back</button>
              <button class="face-tab" data-face="left">Left</button>
              <button class="face-tab" data-face="right">Right</button>
              <button class="face-tab" data-face="top">Top</button>
              <button class="face-tab" data-face="bottom">Bottom</button>
            </div>
          </div>
          <div id="pixel-grid-container" class="pixel-grid-container"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Import Modal -->
  <div id="import-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ãƒ–ãƒ­ãƒƒã‚¯ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</h2>
        <button id="close-import-modal-btn" class="close-btn">&times;</button>
      </div>

      <div class="modal-body">
        <div class="form-group">
          <label for="block-selector">ãƒ–ãƒ­ãƒƒã‚¯ã‚’é¸æŠ</label>
          <input type="text" id="block-selector" class="block-selector" list="block-list" placeholder="ãƒ–ãƒ­ãƒƒã‚¯åã‚’å…¥åŠ›..." autocomplete="off">
          <datalist id="block-list">
          </datalist>
        </div>
        <div id="block-preview" class="block-preview" style="display: none;">
          <p>ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼:</p>
          <div id="block-preview-images"></div>
        </div>
      </div>

      <div class="modal-footer">
        <button id="cancel-import-btn" class="btn-secondary">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button id="execute-import-btn" class="btn-primary" disabled>ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</button>
      </div>
    </div>
  </div>

  <!-- Export Modal -->
  <div id="export-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆè¨­å®š</h2>
        <button id="close-modal-btn" class="close-btn">&times;</button>
      </div>

      <div class="modal-body">
        <div class="form-group">
          <label>ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆç¨®åˆ¥</label>
          <div class="radio-group">
            <label>
              <input type="radio" name="export-type" value="png" checked>
              PNG (å…¨6é¢)
            </label>
            <label>
              <input type="radio" name="export-type" value="pdf">
              PDF (å…¨6é¢)
            </label>
            <label>
              <input type="radio" name="export-type" value="papercraft">
              å±•é–‹å›³
            </label>
          </div>
        </div>

        <div class="form-group">
          <label for="face-size">ä¸€è¾ºã®ã‚µã‚¤ã‚º: <span id="size-value">40</span>mm</label>
          <input type="range" id="face-size" min="10" max="50" value="40" step="1">
        </div>
      </div>

      <div class="modal-footer">
        <button id="cancel-export-btn" class="btn-secondary">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button id="execute-export-btn" class="btn-primary">ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
      </div>
    </div>
  </div>

  <!-- Color Replace Modal -->
  <div id="replace-color-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>è‰²ã‚’ç½®æ›</h2>
        <button id="close-replace-modal-btn" class="close-btn">&times;</button>
      </div>

      <div class="modal-body">
        <div class="form-group">
          <label>ç½®æ›å…ƒã®è‰²</label>
          <div class="color-select-container">
            <input type="color" id="replace-old-color" value="#000000">
            <span id="replace-old-color-label">#000000</span>
          </div>
        </div>

        <div class="form-group">
          <label>ç½®æ›å…ˆã®è‰²</label>
          <div class="color-select-container">
            <input type="color" id="replace-new-color" value="#FFFFFF">
            <span id="replace-new-color-label">#FFFFFF</span>
          </div>
        </div>

        <div class="form-group">
          <label>å¯¾è±¡ç¯„å›²</label>
          <div class="radio-group">
            <label>
              <input type="radio" name="replace-scope" value="current">
              ç¾åœ¨ã®é¢ã®ã¿
            </label>
            <label>
              <input type="radio" name="replace-scope" value="all" checked>
              å…¨6é¢
            </label>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button id="cancel-replace-btn" class="btn-secondary">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button id="execute-replace-btn" class="btn-primary">ç½®æ›</button>
      </div>
    </div>
  </div>

  <script type="importmap">
    {
      "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
        "three/examples/jsm/controls/OrbitControls.js": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/controls/OrbitControls.js"
      }
    }
  </script>
  <script type="module" src="/js/main.js"></script>
</body>
</html>
